# uploads/.htaccess - Bu dosya uploads klasörünün içine konulmalı

# Directory listelemeyi engelle
Options -Indexes

# Tüm HTTP metodlarına izin ver
<LimitExcept GET POST OPTIONS>
    Deny from all
</LimitExcept>

# CORS başlıklarını etkinleştir
Header always set Access-Control-Allow-Origin "*"
Header always set Access-Control-Allow-Methods "GET, POST, OPTIONS"
Header always set Access-Control-Allow-Headers "Content-Type"

# Preflight istekleri için
RewriteCond %{REQUEST_METHOD} OPTIONS
RewriteRule ^(.*)$ $1 [R=200,L]

# PDF dosyalarına erişim kuralları
<FilesMatch "\.(pdf)$">
    # PHP scriptinden erişime izin ver
    SetEnvIfNoCase Referer "^https?://(www\.)?sualpkula\.com/" allowed_referer
    
    Order deny,allow
    Deny from all
    Allow from env=allowed_referer
    Allow from 127.0.0.1
    Allow from ::1
    
    # POST isteklerine izin ver
    <Limit POST>
        Allow from all
    </Limit>
</FilesMatch>

# Önbellekleme kontrolü
<FilesMatch "\.pdf$">
    Header always set Cache-Control "no-store, no-cache, must-revalidate, max-age=0"
    Header always set Pragma "no-cache"
    Header always set Expires "0"
</FilesMatch>
